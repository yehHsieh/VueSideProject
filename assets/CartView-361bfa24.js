import{_ as V,m as w,b as L,S as C,r as y,o,c as n,e as r,d as t,D as b,E as A,F as u,z as g,A as f,t as l,w as p,g as a,G as v}from"./index-820e9b16.js";import{c as I}from"./cart-556f89af.js";const{VITE_APP_URL:m,VITE_APP_PATH:x}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"barproject",BASE_URL:"/VueSideProject/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},S={data(){return{products:[],productId:"",cart:{},loadingItem:"",user:{},couponCode:"",allDiscount:!1,couponOn:!1,isLoading:!1}},computed:{...w(I,["num","carts","total","final_total","originPrice"])},methods:{...L(I,["getCart","deleteItem"]),getProducts(s){this.loadingItem=s,this.isLoading=!0,this.$http.get(`${m}/v2/api/${x}/products/all`).then(d=>{console.log("產品列表:",d.data.products),this.products=d.data.products,this.loadingItem="",this.isLoading=!1})},updateCartItem(s){const d={product_id:s.product.id,qty:s.qty};console.log(d,s.id),this.loadingItem=s.id,this.$http.put(`${m}/v2/api/${x}/cart/${s.id}`,{data:d}).then(k=>{console.log("更新購物車:",k.data),this.getCart(),this.loadingItem=""})},getCoupon(){if(this.couponCode==="drunk")this.allDiscount=!0;else{const s={code:this.couponCode};this.$http.post(`${m}v2/api/${x}/coupon`,{data:s}).then(d=>{console.log(d),this.couponOn=!0,this.getCart(),C.fire({icon:"success",title:d.data.message,showConfirmButton:!1,timer:1700})}).catch(d=>{C.fire({icon:"error",title:"無此優惠券",showConfirmButton:!1,timer:1700}),console.log(d)})}}},mounted(){this.getProducts(),this.getCart()}},E=t("ul",{class:"progresses d-flex py-3 container"},[t("li",{class:"active"},"商品確認"),t("li",null,"訂購人資訊"),t("li",null,"訂單完成")],-1),q={class:"container mb-5 my-lg-5 p-3 bg-secondary",style:{background:"rgba(255, 255, 255, 0.6)","backdrop-filter":"blur(8px)","border-radius":"24px"}},O={class:"d-lg-flex justify-content-between"},T=t("h2",null,"商品確認",-1),U={class:"d-flex justify-content-between"},R={class:"table align-middle block-rwd-show"},B=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"120px"}},"數量/單位"),t("th",null,"單價"),t("th",{class:"text-end"},"金額")])],-1),j=["onClick","disabled"],N=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),M={class:"input-group input-group-sm"},z=["onUpdate:modelValue","onChange","disabled"],F=["value"],H={key:0},G={key:1},J={key:2,class:"text-end"},K=t("small",{class:"text-success"},"價格：",-1),Q={key:3,class:"text-end"},W=t("small",{class:"text-success"},"價格：",-1),X={key:0},Y=t("td",{colspan:"4",class:"text-end"},"折扣金額:",-1),Z={class:"text-end"},$={key:1},tt=t("td",{colspan:"4",class:"text-end"},"折扣金額:",-1),et={class:"text-end"},st={key:2},ot={key:3},nt=t("td",{colspan:"4",class:"text-end text-success"},"最後金額:",-1),lt={class:"text-end text-success"},ct={key:4},dt=t("td",{colspan:"4",class:"text-end text-success"},"最後金額:",-1),it={class:"text-end text-success"},at={colspan:"5",class:"text-end"},rt={class:"table align-middle mt-3 block-rwd-none"},ut={class:"border-bottom"},pt={class:"row"},_t={class:"me-1 col-2"},ht=["onClick","disabled"],gt=t("i",{class:"fas fa-spinner fa-pulse"},null,-1),yt={class:"col-9"},bt={class:"input-group input-group-sm"},ft=["onUpdate:modelValue","onChange","disabled"],mt=["value"],xt={key:0},kt={key:1},Ct={key:0,class:"text-end"},vt=t("small",{class:"text-success text-end"},"價格：",-1),It={key:1,class:"text-end"},Pt=t("small",{class:"text-success text-end"},"價格：",-1),Dt={key:0},Vt={colspan:"4",class:"text-end"},wt={key:1},Lt={key:2},At={key:3},St={colspan:"4",class:"text-end text-success"},Et={key:4},qt={colspan:"4",class:"text-end text-success"},Ot={colspan:"5",class:"text-end"};function Tt(s,d,k,Ut,c,_){const P=y("Loading"),h=y("RouterLink"),D=y("productId");return o(),n(u,null,[r(P,{active:c.isLoading,"z-index":1060},null,8,["active"]),E,t("div",q,[t("div",O,[T,t("div",U,[b(t("input",{type:"text",class:"me-3 rounded-pill p-2","onUpdate:modelValue":d[0]||(d[0]=e=>c.couponCode=e),placeholder:"請輸入優惠碼"},null,512),[[A,c.couponCode,void 0,{trim:!0}]]),t("button",{class:"btn btn-outline-primary rounded-pill py-1 px-4 text-center",onClick:d[1]||(d[1]=(...e)=>_.getCoupon&&_.getCoupon(...e))},"驗證優惠碼")])]),t("table",R,[B,t("tbody",null,[s.carts?(o(!0),n(u,{key:0},g(s.carts,e=>(o(),n("tr",{key:e.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:i=>s.deleteItem(e),disabled:e.id===c.loadingItem},[N,a(" x ")],8,j)]),t("td",null,l(e.product.title),1),t("td",null,[t("div",M,[b(t("select",{class:"form-control",name:"",id:"","onUpdate:modelValue":i=>e.qty=i,onChange:i=>_.updateCartItem(e),disabled:e.id===c.loadingItem},[(o(),n(u,null,g(20,i=>t("option",{value:i,key:`${i}1223`},l(i)+"份",9,F)),64))],40,z),[[v,e.qty]])])]),c.allDiscount?(o(),n("td",H,[t("del",null,l(e.product.origin_price),1),a(" "+l(e.product.price),1)])):(o(),n("td",G,l(e.product.origin_price),1)),c.allDiscount?(o(),n("td",J,[K,a(" "+l(e.total),1)])):(o(),n("td",Q,[W,a(" "+l(e.product.origin_price*e.qty),1)]))]))),128)):f("",!0)]),t("tfoot",null,[c.couponOn?(o(),n("tr",X,[Y,t("td",Z,l(s.total-s.final_total),1)])):f("",!0),c.allDiscount?(o(),n("tr",$,[tt,t("td",et,l(s.originPrice-s.total),1)])):(o(),n("tr",st)),c.couponOn||c.allDiscount?(o(),n("tr",ot,[nt,t("td",lt,l(s.final_total),1)])):(o(),n("tr",ct,[dt,t("td",it,l(s.originPrice),1)])),t("tr",null,[t("td",at,[r(h,{to:"/AllProducts",class:"btn btn-outline-dark me-3 rounded-pill py-1 px-4 text-center"},{default:p(()=>[a("再逛逛")]),_:1}),r(h,{to:"/info",class:"btn btn-primary rounded-pill py-1 px-4 text-center"},{default:p(()=>[a("去結帳 ")]),_:1})])])])]),t("div",rt,[(o(!0),n(u,null,g(s.carts,e=>(o(),n("ul",{key:e.id,class:"p-0"},[t("li",ut,[t("div",pt,[t("div",_t,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:i=>s.deleteItem(e),disabled:e.id===c.loadingItem},[gt,a(" x ")],8,ht)]),t("div",yt,[t("p",null,"品名: "+l(e.product.title),1),t("p",null,[a("數量/單位: "),t("div",bt,[b(t("select",{class:"form-control",name:"",id:"","onUpdate:modelValue":i=>e.qty=i,onChange:i=>_.updateCartItem(e),disabled:e.id===c.loadingItem},[(o(),n(u,null,g(20,i=>t("option",{value:i,key:`${i}1223`},l(i)+"份",9,mt)),64))],40,ft),[[v,e.qty]])])]),t("p",null,[a("單價: "),c.allDiscount?(o(),n("span",xt,[t("del",null,l(e.product.origin_price),1),a(" "+l(e.product.price),1)])):(o(),n("span",kt,l(e.product.origin_price),1))]),t("p",null,[c.allDiscount?(o(),n("span",Ct,[vt,a(" "+l(e.total),1)])):(o(),n("span",It,[Pt,a(" "+l(e.product.origin_price*e.qty),1)]))])])])])]))),128)),t("ul",null,[c.couponOn?(o(),n("li",Dt,[t("p",Vt,"折扣金額:"+l(s.total-s.final_total),1)])):f("",!0),c.allDiscount?(o(),n("li",wt,[r(D,{colspan:"4",class:"text-end"},{default:p(()=>[a("折扣金額:"+l(s.originPrice-s.total),1)]),_:1})])):(o(),n("li",Lt)),c.couponOn||c.allDiscount?(o(),n("li",At,[t("p",St,"最後金額: "+l(s.final_total),1)])):(o(),n("li",Et,[t("p",qt,"最後金額: "+l(s.originPrice),1)])),t("li",null,[t("p",Ot,[r(h,{to:"/AllProducts",class:"btn btn-outline-dark me-3 rounded-pill py-1 px-4 text-center"},{default:p(()=>[a("再逛逛")]),_:1}),r(h,{to:"/info",class:"btn btn-primary rounded-pill py-1 px-4 text-center"},{default:p(()=>[a("去結帳 ")]),_:1})])])])])])],64)}const jt=V(S,[["render",Tt]]);export{jt as default};
